<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dzf.zxkj.jbsz.mapper.BankAccountMapper">

    <select id="query" resultType="com.dzf.zxkj.jbsz.vo.BankAccountVO">
        SELECT
            y.*,
            cp.accountcode,
            cp.accountname
        FROM
            ynt_bankaccount y
            LEFT JOIN ynt_cpaccount cp ON y.relatedsubj = cp.pk_corp_account
        WHERE
            nvl( y.dr, 0 ) = 0
            <if test="isnhsty != null and isnhsty != ''">
                AND state != 1
            </if>
            AND y.pk_corp = #{pk_corp}
        order by y.ts
    </select>
    <select id="existsInBankstatement" resultType="java.lang.Integer">
        select count(1) from ynt_bankstatement where nvl(dr, 0) = 0 and pk_corp = #{pk_corp} and pk_bankaccount = #{bankaccount}
    </select>
</mapper>